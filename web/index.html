<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>adcAM Sniffer</title>
    <link rel="icon" href="logo.ico" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="welcome-screen">
        <div class="welcome-container">
            <div class="welcome-header">
                <img src="logo.ico" alt="Logo" class="welcome-logo">
                <h2>Welcome to adcAM Sniffer</h2>
                <p>Please log in or register to continue</p>
            </div>
            <div class="form-toggle">
                <button id="show-login-btn" class="toggle-btn active">Login</button>
                <button id="show-register-btn" class="toggle-btn">Register</button>
            </div>

            <div id="login-form-container" class="form-container">
                <input type="text" id="login-username" class="custom-input" placeholder="Username" required>
                <input type="password" id="login-password" class="custom-input" placeholder="Password" required>
                <button id="login-btn-action" class="control-btn session-btn">Login</button>
                <p id="login-error" class="form-message"></p>
            </div>

            <div id="register-form-container" class="form-container" style="display: none;">
                <input type="text" id="register-username" class="custom-input" placeholder="Choose a Username" required>
                <input type="password" id="register-password" class="custom-input" placeholder="Choose a Password" required>
                <input type="text" id="register-code" class="custom-input" placeholder="Activation Code" required>
                <button id="register-btn" class="control-btn session-btn">Register</button>
                <p id="register-message" class="form-message"></p>
            </div>
        </div>
    </div>

    <div id="splash-screen" style="display: none;">
        <div class="splash-content">
            <svg class="logo-mm" viewBox="0 0 100 60" width="300">
                <path class="logo-path-1" d="M 10 50 L 20 10 L 30 50 L 40 10 L 50 50" stroke="var(--accent-blue)" fill="none" stroke-width="4" stroke-linecap="round"/>
                <path class="logo-path-2" d="M 50 50 L 60 10 L 70 50 L 80 10 L 90 50" stroke="var(--accent-red)" fill="none" stroke-width="4" stroke-linecap="round"/>
            </svg>
            <p class="splash-text">adcAM Sniffer Initializing...</p>
        </div>
    </div>

    <div class="grid-container" id="main-dashboard" style="display: none;">

        <header class="header">
            <div class="header-left"></div>
            <div class="header-center">
                <img src="logo.ico" alt="App Logo" class="header-logo">
                <div class="header-title-text">
                    <h1>adcAM Sniffer</h1>
                    <p>Real-time Traffic Analysis Dashboard</p>
                </div>
            </div>
            <div class="header-right"></div>
        </header>

        <aside class="sidebar">
            <div class="card interface-card">
                <h2 class="card-title">Network Interfaces</h2>
                <div id="custom-select-wrapper" class="custom-select-container">
                    <div id="select-trigger" class="select-selected">
                        <span>Select an interface...</span>
                    </div>
                    <div id="select-items-container" class="select-items select-hide">
                    </div>
                </div>
            </div>

            <div class="card filter-card">
                <h2 class="card-title">Filter Controls</h2>
                <div class="filter-group">
                    <h3 class="filter-subtitle">Display Filter (Live)</h3>
                    <input type="text" id="display-filter-input" class="custom-input" placeholder="e.g., 192.168.1.1 or http">
                </div>
                <div class="filter-group">
                    <h3 class="filter-subtitle">Quick Capture Filters</h3>
                    <p class="filter-hint">Select a capture filter before starting the sniff.</p>
                    <div class="quick-filter-grid">
                        <button class="quick-filter-btn" data-filter="">
                            <span class="icon">üîÑ</span>
                            <span class="text">Any Traffic</span>
                        </button>
                        <button class="quick-filter-btn" data-filter="tcp port 80">
                            <span class="icon">üåê</span>
                            <span class="text">HTTP</span>
                        </button>
                         <button class="quick-filter-btn" data-filter="tcp port 443">
                            <span class="icon">üîí</span>
                            <span class="text">HTTPS/SSL</span>
                        </button>
                        <button class="quick-filter-btn" data-filter="tcp port 21 or tcp port 20">
                            <span class="icon">üìÇ</span>
                            <span class="text">FTP</span>
                        </button>
                        <button class="quick-filter-btn" data-filter="udp port 53">
                            <span class="icon">üîç</span>
                            <span class="text">DNS</span>
                        </button>
                        <button class="quick-filter-btn" data-filter="icmp">
                            <span class="icon">üì∂</span>
                            <span class="text">ICMP</span>
                        </button>
                    </div>
                    <input type="hidden" id="bpf-filter">
                </div>
            </div>
        </aside>

        <main class="main-content">
            <div class="tabs">
                <button class="tab-link active" data-tab="packets">Live Packets</button>
                <button class="tab-link" data-tab="summary">Session Summary</button>
                <button class="tab-link" data-tab="credentials" id="credentials-tab-btn">
                    Credentials
                    <span id="cred-count-badge" class="badge" style="display: none;">0</span>
                </button>
            </div>
            <div id="packets" class="tab-content active">
                <div class="table-header-controls">
                    <button id="clear-all-btn" class="control-btn clear-btn">
                        <span class="icon">üóëÔ∏è</span><span class="text">Clear All</span>
                    </button>
                    <div class="header-control-divider"></div>
                    <button id="save-all-pcap-btn" class="control-btn session-btn">Save All (PCAP)</button>
                    <button id="export-creds-txt-btn" class="control-btn session-btn">Export Credentials (TXT)</button>
                </div>
                <div class="table-container">
                    <table id="packet-table">
                        <thead>
                            <tr>
                                <th>Time</th><th>Source</th><th>Destination</th><th>Protocol</th><th>Domain</th><th>Size (B)</th><th>Info</th>
                            </tr>
                        </thead>
                        <tbody id="packet-table-body"></tbody>
                    </table>
                </div>
            </div>

            <div id="summary" class="tab-content">
                <div class="summary-container">
                    <div class="card session-name-card">
                        <div class="session-name-wrapper">
                            <h2 id="session-name-display">Current Sniffing Session</h2>
                            <input type="text" id="session-name-input" class="custom-input hidden" value="Current Sniffing Session">
                        </div>
                        <div class="session-name-actions">
                            <button id="edit-name-btn" class="control-btn">Edit</button>
                            <button id="save-name-btn" class="control-btn session-btn hidden">Save</button>
                        </div>
                    </div>
                    <div class="stats-container">
                        <div class="card stat-card">
                            <h2 class="card-title">General Statistics</h2>
                            <div class="stats-list">
                                <div class="stat-item"><span>Total Packets Captured</span><strong id="stat-packet-count">0</strong></div>
                                <div class="stat-item"><span>Credentials Found</span><strong id="stat-cred-count">0</strong></div>
                            </div>
                        </div>
                        <div class="card stat-card">
                            <h2 class="card-title">Top Protocols</h2>
                            <ul id="top-protocols-list" class="stats-list"></ul>
                        </div>
                        <div class="card stat-card">
                            <h2 class="card-title">Top Ports</h2>
                            <ul id="top-ports-list" class="stats-list"></ul>
                        </div>
                    </div>
                </div>
            </div>

            <div id="credentials" class="tab-content">
                <div id="credentials-container" class="credentials-grid"></div>
            </div>
        </main>

        <div id="packet-detail-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Packet Details</h3>
                    <button id="save-single-pcap-btn" class="control-btn session-btn">
                        <span class="icon">üíæ</span> Save Packet (.pcap)
                    </button>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body" id="packet-detail-content"></div>
            </div>
        </div>

        <div id="confirm-modal" class="modal-overlay" style="display: none;">
             <div class="confirm-box">
                <h2>Confirm Deletion</h2>
                <p>Are you sure you want to delete all captured data? This action cannot be undone.</p>
                <div class="confirm-actions">
                    <button id="cancel-delete-btn" class="control-btn btn-cancel">Cancel</button>
                    <button id="confirm-delete-btn" class="control-btn btn-confirm">Yes, Delete</button>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="footer-left">
                <div class="status-indicator-wrapper">
                    <div id="status-indicator" class="status-indicator-off"></div>
                    <div id="status-text">Status: Ready</div>
                </div>
                <div class="status-counts">
                    <span>Packets: <strong id="packet-count">0</strong></span>
                </div>
            </div>
            <div class="footer-controls">
                <button id="toggle-sniff-btn" class="control-btn start-mode">
                    <span class="icon">‚ñ∂</span>
                    <span class="text">Start Sniffing</span>
                </button>
            </div>
        </footer>

    </div>

    <script type="text/javascript" src="/eel.js"></script>
    <script type="text/javascript" src="script.js"></script>
</body>
</html>